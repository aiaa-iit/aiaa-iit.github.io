<!DOCTYPE html>
<head>
    <title>AIAA @ Illinois Tech</title>

    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>

    <link rel="stylesheet" type="text/css" href="css/style.css">
    <link rel="stylesheet" type="text/css" href="css/index.css">

    <script async id="api" src="https://apis.google.com/js/api.js"></script>

    <script id="getnews">
        function GetNews() {
            gapi.load("client", initClient);

            var s = document.getElementById("getnews");
            s.remove();
            s = document.getElementById("api");
            s.remove();
            s.document.getElementById("slide");
            s.remove();
            s.document.getElementById("news-dot");
            s.remove();
        }

        function initClient() {
            gapi.client.init({
                apiKey: "AIzaSyC_CBUPHbZjt2jO3Kg6I7cLIe4y4Mft9KE",
                discoveryDocs: ["https://sheets.googleapis.com/$discovery/rest?version=v4"]
            }).then(() => {
                gapi.client.sheets.spreadsheets.values.get({
                    spreadsheetId: "11LXQyGMqWwMq_cp46vKt9a-t4OgrXjTXv6Xf64oVMTY",
                    range: "News!A:D"
                }).then((response) => {
                    var result = response.result.values;

                    document.getElementsByClassName("slide")[0].remove();

                    var n = result.length < 5 ? result.length : 5;

                    for (var i = 1; i <= n; i++) {
                        var item = result[result.length - i];

                        buildSlide(item[1], item[2], item[3], i);
                    }

                    showSlides(1);
                });
            }, (error) => {
                buildSlide("Could not load news", "", "img/LoadFail.jpg", 1);
            });
        }

        function buildSlide(header, caption, imgSrc, slideNum) {
            var show = document.getElementsByClassName("news-slideshow")[0];

            if ("content" in document.createElement("template")) {
                var t = document.getElementById("slide");

                var src = imgSrc;
                if (typeof src == "undefined" || src == "") {
                    src = "https://drive.google.com/uc?export=view&id=15gPNpZLqL8pkH1RhA6NlXQ7-e_kZuVCe"; // Change this to a different picture
                }

                t.content.querySelector("img").src = src;
                t.content.querySelector("h3").innerText = header;
                t.content.querySelector("p").innerText = caption;

                var c = document.importNode(t.content, true);
                show.insertBefore(c, document.getElementsByClassName("prev")[0]);

                t = document.getElementById("news-dot");
                t.content.querySelector("span").setAttribute("onclick", "setslide(" + slideNum + ")");

                c = document.importNode(t.content, true);
                document.getElementsByClassName("news-dots")[0].appendChild(c);
            } else {
                var slide = document.createElement("div");
                slide.classList.add("slide");
                slide.classList.add("fade");
                slide.style = "display:none";
                show.insertBefore(slide, document.getElementsByClassName("prev")[0]);

                var src = imgSrc;
                if (typeof src == "undefined" || src == "") {
                    src = "https://drive.google.com/uc?export=view&id=15gPNpZLqL8pkH1RhA6NlXQ7-e_kZuVCe"; // Change this to a different picture
                }

                var img = document.createElement("img");
                img.setAttribute("src", src);
                slide.appendChild(img);

                var capt = document.createElement("div");
                capt.classList.add("slide-caption");
                slide.appendChild(capt);

                var head = document.createElement("h3");
                head.appendChild(document.createTextNode(header));
                capt.appendChild(head);

                var par = document.createElement("p");
                par.appendChild(document.createTextNode(caption));
                capt.appendChild(par);

                var dots = document.getElementsByClassName("news-dots")[0];
                var dot = document.createElement("span");
                dot.classList.add("dot");
                dot.setAttribute("onclick", "setslide(" + slideNum + ")");
                dots.append(dot);
            }
        }
    </script>

    <template id="slide">
        <div class="slide fade">
            <img src="">
            <div class="slide-caption">
                <h3></h3>
                <p></p>
            </div>
        </div>
    </template>
    <template id="news-dot">
        <span class="dot" onlick=""></span>
    </template>

    <script type="text/javascript" src="js/index.js"></script>
    <script type="text/javascript" src="js/main.js"></script>
</head>
<html>
    <body>
        <div class="header">
            <h1>AIAA @ Illinois Tech</h1>
        </div>
        <div class="content">
            <div class="row" style="margin: 0 15px">
                <div class="notice col-12 col-s-12">
                    <i class="fa fa-info-circle"></i>
                    <p>Our <a href="https://mypages.iit.edu/~aiaa/">current website</a> is inaccessible to us at the moment. We are currently trying to regain access. This will be our home until further notice.</p>
                </div>
            </div>
            
            <div class="row">
                <div class="col-8 col-s-12">
                    <div class="news-slideshow">
                        <div class="slide fade">
                            <img src="img/LoadNews.jpg">
                            <div class="slide-caption">
                                <h3>Loading News</h3>
                            </div>
                        </div>
                        <a class="prev" onclick="moveslide(-1)">
                            <!--&#10094;-->
                            <i class="fas fa-angle-left" style="vertical-align: middle; font-size: 1.25em;"></i>
                        </a>
                        <a class="next" onclick="moveslide(1)">
                            <!--&#10095;-->
                            <i class="fas fa-angle-right" style="vertical-align: middle; font-size: 1.25em;"></i>
                        </a>
                    </div>
                    <div class="news-dots">
                    </div>
                </div>
                <div class="quick-info col-3 col-s-12">
                    <h3>DBF Meeting Times</h3>
                    <p><b>General:</b> Friday 3:00 pm</p>
                    <p><b>Aero:</b> Wednesday 12:50 pm & 4:00 pm</p>
                    <p><b>Propulsion:</b> Tuesday 3:00 pm</p>
                    <p><b>Structures:</b> Wednesday 6:00 pm</p>
                    <h3>Rocketry Meeting Times</h3>
                    <p>Thursday 3:00 pm</p>
                </div>
            </div>
        </div>
        <div class="footer">
            <p style="text-align: center;">AIAA IIT</p>
        </div>
    </body>
</html>